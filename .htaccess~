<IfModule mod_rewrite.c>
    <IfModule mod_negotiation.c>
        Options -MultiViews
    </IfModule>

    RewriteEngine On

    # Redirect Trailing Slashes If Not A Folder...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)/$ /$1 [L,R=301]

    # Handle Front Controller...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
	RewriteCond  expr "! %{REQUEST_FILENAME} -strmatch '*storageasset*'"
    RewriteRule ^ index.php [L]
	
	RewriteBase /
	RewriteCond  expr " %{REQUEST_FILENAME} -strmatch '*storageasset*'"
	RewriteRule ^storageasset/(.+)/(.+)/(.+)/(.+)$ storage/app/public/$1/$2/$3/$4
	RewriteRule ^storageasset/(.+)/(.+)/(.+)$ storage/app/public/$1/$2/$3
	RewriteRule ^storageasset/(.+)/(.+)$ storage/app/public/$1/$2
	RewriteRule ^storageasset/(.+)$ storage/app/public/$1

    # Handle Authorization Header
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
</IfModule>
